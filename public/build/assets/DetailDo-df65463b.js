import{q as C,r as o,j as a,a as R,R as w,c as g}from"./app-03fb5093.js";import{F as c}from"./FormatNumbering-2d395679.js";import{u as M,T as S,a as v,b as s,c as b,f as i,d as A,e as d,h as H,g as _}from"./index-a2cbdac7.js";import{d as j}from"./dayjs.min-3ce3b738.js";import"./react-number-format.es-8e86fb37.js";import"./utils-01642ffa.js";const q=({triggerId:n})=>{const{server_filter:f}=C().props,[h,p]=o.useState([]),[T,m]=o.useState(!0);o.useState();const[u,x]=o.useState({totalPinjaman:0,totalPembayaran:0}),y=e=>e.reduce((l,t)=>(l.totalNominal+=t.nominal||0,l),{totalNominal:0}),D=o.useMemo(()=>[{accessorKey:"transaction_date",id:"transaction_date",cell:e=>a("div",{className:"text-center",children:e.getValue()&&j(e.getValue()).format("DD-MM-YYYY")}),footer:"Total",header:()=>"Tanggal Transaksi"},{accessorKey:"nominal",id:"nominal",cell:e=>a(c,{value:e.getValue()}),header:()=>"Pembayaran",footer:e=>a(c,{value:u.totalNominal})},{accessorKey:"total_pembayaran",id:"total_pembayaran",cell:e=>a(c,{value:e.getValue()}),header:()=>"Total Stor DO"}],[u]);o.useEffect(()=>{if(n===null)return;const e=new AbortController;return(async()=>{try{const t=await g.get(route("goroumrah.requestDoUnit"),{params:{branch_id:n,bulan:f.bulan},signal:e.signal});p(t.data.data);const N=y(t.data.data);x(N)}catch(t){g.isCancel(t)?console.log("Request canceled:",t.message):(setError(t),m(!1))}finally{m(!1)}})(),()=>{e.abort()}},[n]);const r=M({data:h,columns:D,getCoreRowModel:_(),debugTable:!0,debugHeaders:!0,debugColumns:!1});return a("div",{className:"max-h-[40vh] overflow-auto",children:R(S,{className:"lg:text-sm text-xs",children:[a(v,{children:r.getHeaderGroups().map(e=>a(s,{className:"bg-gray-100",children:e.headers.map(l=>a(b,{className:"text-center ",children:i(l.column.columnDef.header,l.getContext())},l.id))},e.id))}),a(A,{children:T?a(s,{children:a(d,{colSpan:"4",children:"SILAHKAN TUNGGU DATA MASIH DIMUAT"})}):r.getRowModel().rows.length?r.getRowModel().rows.map((e,l)=>a(w.Fragment,{children:a(s,{id:e.id,children:e.getVisibleCells().map(t=>a(d,{className:`w-1/4 ${t.column.columnDef.className}`,children:i(t.column.columnDef.cell,t.getContext())},t.id))},e.id)},e.id)):a(s,{children:a(d,{colSpan:"4",children:"Belum Ada Data Pembayaran Goro Umrah"})})}),a(H,{children:r.getFooterGroups().map(e=>a(s,{children:e.headers.map(l=>a(b,{className:"text-center bg-gray-100 text-blue-600 py-5",children:i(l.column.columnDef.footer,l.getContext())},l.id))},e.id))})]})})};export{q as default};

import{W as N,r as s,j as e,a as v,R as C,b}from"./app-142f56b6.js";import{F as o}from"./FormatNumbering-73a7e798.js";import{u as R,T as w,a as M,b as n,c as g,f as d,d as S,e as m,g as A,h as H}from"./table-547a8e57.js";import{d as K}from"./dayjs.min-6f54ee33.js";import"./react-number-format.es-00bf3fe6.js";import"./utils-01642ffa.js";const G=({triggerId:c})=>{const{server_filter:f,datas:h}=N().props,[p,y]=s.useState([]),[T,u]=s.useState(!0);s.useState();const[i,x]=s.useState({totalPinjaman:0,totalPembayaran:0}),j=a=>a.reduce((l,t)=>(l.totalPinjaman+=t.pinjaman||0,l.totalPembayaran+=t.bayar||0,l),{totalPinjaman:0,totalPembayaran:0}),D=s.useMemo(()=>[{accessorKey:"transaction_date",id:"transaction_date",cell:a=>e("div",{className:"text-center",children:a.getValue()&&K(a.getValue()).format("DD-MM-YYYY")}),footer:"Total",header:()=>"Tanggal Transaksi"},{accessorKey:"pinjaman",id:"pinjaman",cell:a=>e(o,{value:a.getValue()}),header:()=>"Pinjaman",footer:a=>e(o,{value:i.totalPinjaman})},{accessorKey:"bayar",id:"bayar",cell:a=>e(o,{value:a.getValue()}),header:()=>"Pembayaran",footer:a=>e(o,{value:i.totalPembayaran})},{accessorKey:"sisa",id:"sisa",cell:a=>e(o,{value:a.getValue()}),header:()=>"Sisa"}],[i]);s.useEffect(()=>{if(c===null)return;const a=new AbortController;return(async()=>{try{const t=await b.get(route("goroumrah.requestPinjamanUnit"),{params:{branch_id:c,bulan:f.bulan},signal:a.signal});y(t.data.data);const P=j(t.data.data);x(P)}catch(t){b.isCancel(t)?console.log("Request canceled:",t.message):(setError(t),u(!1))}finally{u(!1)}})(),()=>{a.abort()}},[c,h]);const r=R({data:p,columns:D,getCoreRowModel:H(),debugTable:!0,debugHeaders:!0,debugColumns:!1});return e("div",{className:"max-h-[40vh] overflow-auto",children:v(w,{className:"lg:text-sm text-xs",children:[e(M,{children:r.getHeaderGroups().map(a=>e(n,{className:"bg-gray-100",children:a.headers.map(l=>e(g,{className:"text-center ",children:d(l.column.columnDef.header,l.getContext())},l.id))},a.id))}),e(S,{children:T?e(n,{children:e(m,{colSpan:"4",children:"SILAHKAN TUNGGU DATA MASIH DIMUAT"})}):r.getRowModel().rows.length?r.getRowModel().rows.map((a,l)=>e(C.Fragment,{children:e(n,{id:a.id,children:a.getVisibleCells().map(t=>e(m,{className:`w-1/4 ${t.column.columnDef.className}`,children:d(t.column.columnDef.cell,t.getContext())},t.id))},a.id)},a.id)):e(n,{children:e(m,{colSpan:"4",children:"Belum Ada Data Pembayaran Goro Umrah"})})}),e(A,{children:r.getFooterGroups().map(a=>e(n,{children:a.headers.map(l=>e(g,{className:"text-center bg-gray-100 text-blue-600 py-5",children:d(l.column.columnDef.footer,l.getContext())},l.id))},a.id))})]})})};export{G as default};

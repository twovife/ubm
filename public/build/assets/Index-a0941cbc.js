import{r as o,j as a,a as n,R as B,F as K}from"./app-0b5f1112.js";import{A as V,C as c}from"./AuthenticatedLayout-76bbb813.js";import{F as i,u as $,T as k,a as H,b as d,c as C,f as m,d as W,e as N,g as A,h as E}from"./index-8708f93e.js";import{S as L}from"./Search-e4ee1428.js";import{F as O}from"./index.esm-873aad8d.js";import{d as U}from"./dayjs.min-068b8e04.js";import G from"./DetailKasbon-b75ed336.js";import q from"./Create-45ba25b6.js";import"./transition-7051d0f9.js";import"./Loading-9e25d30e.js";import"./iconBase-88429f7d.js";import"./index.esm-ad7e6b0e.js";import"./react-number-format.es-04b13629.js";import"./utils-01642ffa.js";import"./PrimaryButton-15ae1d1a.js";import"./SelectList-a39251a6.js";import"./useServerFilter-89952a47.js";import"./TextInput-67fb2e62.js";import"./ButtonWrapper-9d00536d.js";import"./dialog-b69886c9.js";import"./InputLabel-c173db8f.js";import"./index.esm-5915bcd6.js";import"./InputError-8fa33d66.js";const ye=({datas:j,...g})=>{const S=U(g.server_filter.bulan).format("MMM"),[h,T]=o.useState(!1),[p,z]=o.useState(()=>j),[l,v]=o.useState(),f=e=>{v(t=>t===e?null:e)},u=(e=>e.reduce((t,r)=>(t.totalPinjaman+=r.total_pinjaman||0,t.totalPembayaran+=r.bayar_on||0,t.totalSisa+=r.sisa||0,t),{totalPinjaman:0,totalPembayaran:0,totalSisa:0}))(p),w=o.useMemo(()=>[{accessorKey:"unit",id:"collapse",cell:e=>e.getValue(),header:()=>"Unit"},{accessorKey:"total_pinjaman",id:"total_pinjaman",cell:e=>a(i,{value:e.getValue()}),header:()=>"Pinjaman",footer:e=>a(i,{value:u.totalPinjaman})},{accessorKey:"bayar_on",id:"bayar_on",cell:e=>a(i,{value:e.getValue()}),header:()=>`Pembayaran ${S}`,footer:e=>a(i,{value:u.totalPembayaran})},{accessorKey:"sisa",id:"sisa",cell:e=>a(i,{value:e.getValue()}),header:()=>"Sisa Pinjaman",footer:e=>a(i,{value:u.totalSisa})}],[]),s=$({data:p,columns:w,getCoreRowModel:E()}),[_,b]=o.useState(),[P,x]=o.useState(),[D,F]=o.useState(),[M,y]=o.useState(!1),R=(e,t,r)=>{y(!0),b(e),x(t),F(r)},I=e=>{y(!1),b(null),x(null)};return o.useEffect(()=>{f(parseInt(g.unit_show.branch))},[]),n(V,{loading:h,children:[n(c,{judul:"Goro Umrah",children:[a(c.subTitle,{children:n("div",{className:"flex lg:flex-row flex-col lg:justify-between items-center gap-3",children:[a(c.startContent,{className:"flex-wrap mb-3 lg:mb-0"}),a(c.endContent,{className:"flex-wrap",children:a(L,{loading:h,setLoading:T,urlLink:route("goroumrah.goro_index"),localState:"goroumrah_goro_index",availableMonth:!0})})]})}),a("div",{className:"overflow-auto rounded-lg shadow",children:n(k,{className:"border text-xs",children:[a(H,{children:s.getHeaderGroups().map(e=>a(d,{children:e.headers.map(t=>a(C,{className:"text-center",children:m(t.column.columnDef.header,t.getContext())},t.id))},e.id))}),a(W,{children:s.getRowModel().rows.length?s.getRowModel().rows.map((e,t)=>n(B.Fragment,{children:[a(d,{id:e.id,className:`${l==e.original.id?"border-b-0":""}`,children:e.getVisibleCells().map(r=>a(N,{className:`${r.column.columnDef.className} w-1/4`,children:r.column.id=="collapse"?n("div",{className:"flex w-full items-center justify-center gap-3",children:[a("button",{onClick:()=>f(e.original.id),className:`flex justify-center items-start hover:text-roman-500 ${l==e.original.id?"rotate-90 text-roman-500":""} `,children:a(O,{})}),a("button",{className:"px-2 py-1 text-xs border border-gray-400 rounded hover:bg-gray-400 hover:text-white",onClick:()=>R(e.original.unit_id,e.original.unit,e.original.wilayah),children:m(r.column.columnDef.cell,r.getContext())})]}):l==e.original.id?"":m(r.column.columnDef.cell,r.getContext())},r.id))},e.id),l==e.original.id&&a(K,{children:a(d,{className:"p-0",children:a(N,{colSpan:"4",className:"p-0 border-0",children:a(G,{triggerId:l})})},`newrow${e.id}`)})]},e.id)):null}),l?"":a(A,{children:s.getFooterGroups().map(e=>a(d,{children:e.headers.map(t=>a(C,{className:"text-center bg-gray-100 text-black",children:m(t.column.columnDef.footer,t.getContext())},t.id))},e.id))})]})})]}),a(q,{open:M,onClosed:I,triggeredId:_,triggeredBranch:P,triggeredWilayah:D})]})};export{ye as default};

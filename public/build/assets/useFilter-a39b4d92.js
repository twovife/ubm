import{j as r,r as h}from"./app-2e3742d5.js";const g=({children:t,className:s,maxH:n="max-h-[60vh] lg:max-h-[70vh]"})=>r("div",{className:`overflow-auto ${n} ${s}`,children:r("table",{className:"w-full divide-y divide-gray-200 text-xs lg:text-sm relative z-0",children:t})}),z=({children:t})=>r("thead",{className:"sticky top-0 left-0 z-10",children:r("tr",{className:"bg-gray-300 shadow-sm",children:t})}),P=({children:t})=>r("tbody",{className:"divide-y divide-gray-200 relative z-0 text-gray-700 text-xs",children:t}),A=({className:t,children:s})=>r("tr",{className:`odd:bg-white even:bg-gray-100 hover:bg-roman-50/50 group ${t}`,children:s}),j=({nested:t=!1,children:s,noSpace:n,className:c})=>{let i=[];return t?i.push(r("td",{className:"px-3 py-1.5 sticky left-0 top-0 z-10 bg-inherit",children:r("div",{className:"grid grid-cols-5 gap-1",children:s})},1)):i.push(r("td",{scope:"col",className:`px-3 py-1.5 group-hover:bg-inherit ${n?" whitespace-nowrap ":""} ${c}  `,children:s},2)),i},J=(t,s)=>{let n=[];return t.forEach((c,i)=>{c.filterable=="no"?n.push(r("div",{className:"col-span-1 px-6 py-1.5 text-center",children:c.name},i)):c.filterable=="yes"&&n.push(r("div",{className:"col-span-4 px-6 py-1.5 filterthis hover:cursor-pointer hover:bg-gray-500 hover:text-white text-center","data-type":c.type_date,"data-name":c.column,children:c.name},i))}),r("th",{scope:"col",className:`${s?"sticky":""} left-0 top-0 z-10 bg-inherit `,children:r("div",{className:"grid grid-cols-5 gap-1 lg:w-[20vw] w-[40vw] ",children:n})})},O=t=>t.filterable=="yes"?r("th",{scope:"col",className:"px-6 py-1.5 whitespace-nowrap filterthis hover:cursor-pointer hover:bg-gray-500 hover:text-white text-center","data-type":t.type_date,"data-name":t.column,children:t.name}):r("th",{scope:"col",className:"px-6 py-1.5 whitespace-nowrap text-center",children:t.name}),B=({type:t,sticky:s=!1,headers:n})=>t=="nested"?J(n,s):O(n);g.thead=z;g.th=B;g.td=j;g.tr=A;g.tbody=P;function R(t,s,n){const c=localStorage.getItem(n),i={oldFilter:[],oldPage:1};let d;try{d=JSON.parse(c),(!d||typeof d!="object"||!("oldFilter"in d)||!("oldPage"in d))&&(d=i)}catch{d=i}const{oldFilter:N,oldPage:F}=d,[k,v]=h.useState(!1),[u,w]=h.useState(N),[S,b]=h.useState({}),[x,D]=h.useState([]),[p,y]=h.useState(F),[_,T]=h.useState(0);h.useEffect(()=>{const e=a=>{a.target.classList.contains("filterthis")&&(v(!0),b({name:a.target.getAttribute("data-name"),data_type:a.target.getAttribute("data-type")}))};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[]);const C=e=>{u.some(o=>o.name===e.name&&o.search_key.toLowerCase()===e.search_key.toLowerCase())||w([...u,{...e,id:u.length+1}]),y(1)},E=e=>{w(a=>a.filter(o=>o.id!==e)),y(1)},L=(e,a)=>a.length===0?e:e.filter(o=>a.every(l=>{switch(l.operator){case 2:return o[l.name]==l.search_key;case 4:return o[l.name]>l.search_key;case 5:return o[l.name]<l.search_key;case 1:return l.data_type==="text"?o[l.name].toLowerCase().includes(l.search_key.toLowerCase()):o[l.name].includes(l.search_key);default:return e}})),m=(e,a)=>{const o=L(e,a);return T(Math.ceil(o.length/s)),o.slice((p-1)*s,p*s)};h.useEffect(()=>{const e=m(t,u);D(e),localStorage.setItem(n,JSON.stringify({oldFilter:u,oldPage:p}))},[p,u]);const $=e=>{y(e)};let f={};return x.forEach(e=>{for(let a in e)a!=="wilayah"&&a!=="bulan"&&(f[a]=(parseInt(f[a])||0)+parseInt(e[a]??0))}),{showFilter:k,setShowFilter:v,filter:u,whenFilterrAdding:C,addFilter:S,setAddFilter:b,removeFilter:E,returnedData:x,totalPages:_,currentPage:p,displayData:m,handlePageChange:$,setCurrentPage:y,totals:f}}export{g as D,R as u};

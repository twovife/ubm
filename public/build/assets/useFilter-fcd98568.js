import{j as s,r as i}from"./app-b6de9a88.js";const g=({children:e,className:r,maxH:n="max-h-[60vh] lg:max-h-[70vh]"})=>s("div",{className:`overflow-auto ${n} ${r}`,children:s("table",{className:"w-full divide-y divide-gray-200 text-xs lg:text-sm relative z-0",children:e})}),A=({children:e})=>s("thead",{className:"sticky top-0 left-0 z-10",children:s("tr",{className:"bg-gray-300 shadow-sm",children:e})}),j=({children:e})=>s("tbody",{className:"divide-y divide-gray-200 relative z-0 text-gray-700 text-xs",children:e}),J=({className:e,children:r})=>s("tr",{className:`odd:bg-white even:bg-gray-100 hover:bg-roman-50/50 group ${e}`,children:r}),O=({nested:e=!1,children:r,noSpace:n,className:c})=>{let d=[];return e?d.push(s("td",{className:"px-3 py-1.5 sticky left-0 top-0 z-10 bg-inherit",children:s("div",{className:"grid grid-cols-5 gap-1",children:r})},1)):d.push(s("td",{scope:"col",className:`px-3 py-1.5 group-hover:bg-inherit ${n?" whitespace-nowrap ":""} ${c}  `,children:r},2)),d},B=(e,r)=>{let n=[];return e.forEach((c,d)=>{c.filterable=="no"?n.push(s("div",{className:"col-span-1 px-6 py-1.5 text-center",children:c.name},d)):c.filterable=="yes"&&n.push(s("div",{className:"col-span-4 px-6 py-1.5 filterthis hover:cursor-pointer hover:bg-gray-500 hover:text-white text-center","data-type":c.type_date,"data-name":c.column,children:c.name},d))}),s("th",{scope:"col",className:`${r?"sticky":""} left-0 top-0 z-10 bg-inherit `,children:s("div",{className:"grid grid-cols-5 gap-1 lg:w-[20vw] w-[40vw] ",children:n})})},M=e=>e.filterable=="yes"?s("th",{scope:"col",className:"px-6 py-1.5 whitespace-nowrap filterthis hover:cursor-pointer hover:bg-gray-500 hover:text-white text-center","data-type":e.type_date,"data-name":e.column,children:e.name}):s("th",{scope:"col",className:"px-6 py-1.5 whitespace-nowrap text-center",children:e.name}),R=({type:e,sticky:r=!1,headers:n})=>e=="nested"?B(n,r):M(n);g.thead=A;g.th=R;g.td=O;g.tr=J;g.tbody=j;function W(e,r,n){const[c,d]=i.useState(()=>e);i.useEffect(()=>{d(e)},[e]);const F=localStorage.getItem(n),v={oldFilter:[],oldPage:1};let u;try{u=JSON.parse(F),(!u||typeof u!="object"||!("oldFilter"in u)||!("oldPage"in u))&&(u=v)}catch{u=v}const{oldFilter:k,oldPage:S}=u,[D,w]=i.useState(!1),[h,b]=i.useState(k),[_,x]=i.useState({}),[m,E]=i.useState([]),[p,y]=i.useState(S),[T,C]=i.useState(0);i.useEffect(()=>{const t=a=>{a.target.classList.contains("filterthis")&&(w(!0),x({name:a.target.getAttribute("data-name"),data_type:a.target.getAttribute("data-type")}))};return window.addEventListener("click",t),()=>{window.removeEventListener("click",t)}},[]);const L=t=>{h.some(o=>o.name===t.name&&o.search_key.toLowerCase()===t.search_key.toLowerCase())||b([...h,{...t,id:h.length+1}]),y(1)},$=t=>{b(a=>a.filter(o=>o.id!==t)),y(1)},z=(t,a)=>a.length===0?t:t.filter(o=>a.every(l=>{switch(l.operator){case 2:return o[l.name]==l.search_key;case 4:return o[l.name]>l.search_key;case 5:return o[l.name]<l.search_key;case 1:return l.data_type==="text"?o[l.name].toLowerCase().includes(l.search_key.toLowerCase()):o[l.name].includes(l.search_key);default:return t}})),N=(t,a)=>{const o=z(t,a);return C(Math.ceil(o.length/r)),o.slice((p-1)*r,p*r)};i.useEffect(()=>{const t=N(c,h);E(t),localStorage.setItem(n,JSON.stringify({oldFilter:h,oldPage:p}))},[p,h,c]);const P=t=>{y(t)};let f={};return m.forEach(t=>{for(let a in t)a!=="wilayah"&&a!=="bulan"&&(f[a]=(parseInt(f[a])||0)+parseInt(t[a]??0))}),{showFilter:D,setShowFilter:w,filter:h,whenFilterrAdding:L,addFilter:_,setAddFilter:x,removeFilter:$,returnedData:m,totalPages:T,currentPage:p,displayData:N,handlePageChange:P,setCurrentPage:y,totals:f}}export{g as D,W as u};
